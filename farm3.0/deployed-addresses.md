# 已部署合约地址 (Monad Testnet) - 最新版本

## 网络信息
- **网络名称**: Monad Testnet
- **链ID**: 10143
- **RPC URL**: https://testnet-rpc.monad.xyz
- **部署者地址**: 0x13BA139880896d9DbaFD96Bf79233fCBF564C2C9
- **部署区块**: 38771246
- **部署时间**: 2025-01-21 (偷菜功能修复版本)

## ⚠️ 重要更新说明
**更新原因**: 修复偷菜功能设计缺陷，添加forceTransfer支持
**新增功能**: 完整的偷菜机制，支持玩家偷取他人成熟作物
**保持特性**: 天气段间隔仍为1分钟，保持优化的游戏体验

## 已部署合约 ✅ (偷菜修复版本)

### 1. SeedNFT (种子NFT合约) ⭐ 新增偷菜支持
- **地址**: `0x8D70C360B9CB748879B3999162cFf15A109246a6`
- **功能**: 管理种子/作物NFT的生命周期 (Seed → Growing → Mature)
- **权限**: 由FarmGame合约管理
- **🆕 新增**: forceTransfer函数支持偷菜时的NFT强制转移

### 2. KindnessToken (善良值代币合约)
- **地址**: `0xbC8894f59E100530627f4C0429fc19488710e05A`
- **功能**: ERC-20代币，玩家助人获得奖励
- **权限**: 由FarmGame合约管理

### 3. LandNFT (土地NFT合约) ⭐ 优化版本
- **地址**: `0xd9E5b3E6e6F82cC496D50A6c1cD92436772f8d82`
- **功能**: 管理100块土地，状态机和天气系统
- **土地总数**: 100块
- **权限**: 由FarmGame合约管理
- **🔧 优化**: 天气段间隔为1分钟

### 4. Shop (商店合约)
- **地址**: `0xC7433bA91a619E7F028d1514bf1Acd3B709ea450`
- **功能**: 种子购买商店，支持原生代币和KIND代币购买
- **权限**: 由FarmGame合约管理

### 5. FarmGame (主游戏合约) ✅ 完整功能版本
- **地址**: `0xC78A9f1c981AF40CCAFd4F58E45c61bbcdE7Fb46`
- **功能**: 游戏主逻辑协调器，统一入口
- **特性**:
  - ✅ 统一种子购买接口 (`buySeedWithNative/Kind`)
  - ✅ 土地抢占和作物管理
  - ✅ 区块哈希随机数天气系统 (已优化)
  - ✅ 助人系统和KIND代币奖励
  - ✅ 完整权限管理
  - 🆕 完整偷菜功能 (`stealCrop`)

## 权限架构 ✅
- **中央化管理**: FarmGame合约拥有所有子合约的Owner权限
- **安全性**: 所有游戏操作通过FarmGame合约统一处理
- **扩展性**: 便于未来功能升级和维护

## 测试账户信息

### 部署者账户 (管理员)
- **地址**: 0x13BA139880896d9DbaFD96Bf79233fCBF564C2C9
- **私钥**: 969c429a493c6c0782474798aa2c0fbc96847e05ce3ebe457486bb93b3d343d7

### 测试账户1 (玩家A)
- **地址**: 0x45e1913258cb5dFC3EE683beCCFEBb0E3102374f
- **私钥**: 6e624f2006b84453d1b76e56f503a7e5026f407a95f210e61fa5026e7afffda5

### 测试账户2 (玩家B)
- **地址**: 0xd857e1E4E3c042B1cF0996E89A54C686bA87f8E2
- **私钥**: 2df90fa7e3eba925e55fc0a65abb03a08b4e78ffc02d2b523533a66a93adba7f

## 游戏流程

### 基本操作流程
1. **购买种子**: `farmGame.buySeedWithNative(cropType)` 或 `farmGame.buySeedWithKind(cropType)`
2. **抢占土地**: `farmGame.claimLand(landId, tokenId)`
3. **检查生长**: `farmGame.checkAndAdvanceGrowth(landId)` ⭐ 现在1分钟间隔有效
4. **收获作物**: `farmGame.harvestCrop(landId)`
5. **偷取作物**: `farmGame.stealCrop(landId)`

### 助人系统
- **浇水**: `farmGame.helpOther(landId, 0, payWithKind)`
- **施肥**: `farmGame.helpOther(landId, 1, payWithKind)`
- **奖励**: 每次助人获得1 KIND代币
- **限制**: 每天最多帮助15次

### 种子类型和价格
- **普通种子** (原生代币购买):
  - 小麦: 0.001 ETH (60分钟)
  - 玉米: 0.0015 ETH (90分钟)
  - 南瓜: 0.002 ETH (120分钟)
- **稀有种子** (KIND代币购买):
  - 草莓: 10 KIND (75分钟)
  - 葡萄: 15 KIND (100分钟)
  - 西瓜: 20 KIND (110分钟)

## 技术特性

### 天气系统 ✅ (已修复)
- **随机性**: 区块哈希 + 时间戳 + 用户地址 + 土地ID
- **天气类型**: 晴天(40%) / 雨天(25%) / 阴天(15%) / 暴风雨(20%)
- **影响**: 晴天正常 / 雨天+20% / 阴天-10% / 暴风雨暂停
- **🔧 修复**: 时间段从15分钟改为1分钟，大幅提升响应速度

### 增长机制 ✅ (已优化)
- **懒惰计算**: 仅在玩家交互时计算生长进度
- **助推器系统**: 浇水(-2分钟) / 施肥(-5%) / 最多10次
- **状态机**: 空闲 → 生长中 → 成熟 → 冷却锁定
- **🔧 优化**: 现在每1分钟都可以产生生长进度

## 修复前后对比

### 修复前 ❌
- 天气段间隔: 15分钟
- 问题: 玩家需等待15+分钟才能看到任何生长
- 用户体验: 非常差，测试困难

### 修复后 ✅
- 天气段间隔: 1分钟
- 改进: 玩家1分钟后即可看到生长进度
- 用户体验: 显著提升，测试友好

## 部署状态总结 ✅
- ✅ 所有5个核心合约重新部署成功
- ✅ 天气系统关键bug修复 (15分钟→1分钟)
- ✅ 权限架构配置完成
- ✅ 统一游戏入口实现
- ✅ 准备进行修复验证测试

## 旧版本地址 (已废弃)
旧版本存在天气系统bug，请使用上述新版本地址：
- 旧FarmGame: 0xff91290e0fB079097c6C6b7b68961E88ECB5E7E0 (已废弃)
- 旧LandNFT: 0x714e649777364d4D8d211E80c7Ee5EbD54115285 (已废弃)