链上农场（Monad）MVP实现方案：仅使用合约和前端
项目内容概述
本项目基于“链上农场（Monad）设计规范 v1.3”，旨在在Monad高性能区块链上构建一个去中心化农场游戏。游戏结合NFT（种子/作物和土地）、ERC-20代币（KIND善良值）和预言机（Gelato VRF用于天气随机数），形成一个完整的链游闭环。核心玩法包括抢地→种植→成长→收割/偷菜→冷却→再次抢地，同时融入善良值激励（帮助他人获得KIND）和天气动态（影响成长速度）。
一、总体目标
实现一个具备以下特征的去中心化农场游戏：
•	链上交互闭环：抢地、种植、成长、收割/偷菜、冷却、再抢地。
•	善良值激励：玩家帮助他人浇水/施肥获得KIND。
•	天气动态：每块土地独立天气，通过Gelato VRF生成随机影响成长速度。
二、资产体系
1.	种子与作物（SeedNFT）： 
o	类型：ERC-721。
o	生命周期：同一NFT从种子→成长中→成熟作物，属性动态更新。
o	属性：cropType（作物种类，如小麦、玉米、草莓等）、rarity（稀有度：普通/稀有/传说）、growthStage（Seed/Growing/Mature）、growthStartTime（成长开始时间）、baseGrowthTime（基础成长时间：1h–2h）、maturedAt（成熟时间戳）、boostersApplied（道具加速次数）。
o	获取方式：普通种子用Monad原生币购买；稀有种子用KIND兑换。
o	作用：成熟后收割计入用户作物数量（排行榜依据）；NFT作为成果展示和积分凭证。
2.	善良值（KindnessToken，KIND）： 
o	类型：ERC-20。
o	获得方式：帮助他人浇水/施肥；每日奖励上限15次。
o	用途：在商店兑换稀有种子或购买加速道具（浇水/施肥）。
o	排序：排行榜第二维度基于用户持有KIND数量。
3.	土地（LandNFT）： 
o	类型：ERC-721。
o	唯一性：地图上土地数量固定，每块地唯一。
o	状态机：Idle（空闲）、Growing（成长中）、Ripe（成熟待收获）、Stealing（偷菜中，临时状态）、LockedIdle（冷却中，5分钟）。
o	抢地流程： 
1.	玩家占领Idle土地→状态切换到Growing。
2.	VRF随机数触发天气→影响作物成长时间。
3.	成熟→状态切换为Ripe，等待收割或偷菜。
4.	收割或偷菜完成→进入LockedIdle（冷却5分钟）→再次Idle。
三、作物与成长时间设计
1.	普通作物（原生币购买）： 
o	小麦：60分钟。
o	玉米：90分钟。
o	南瓜：120分钟。
2.	稀有作物（KIND兑换）： 
o	草莓：75分钟。
o	葡萄：100分钟。
o	西瓜：110分钟。
四、天气与动态事件
•	天气机制： 
o	触发：每块土地独立，不共享全局天气。
o	随机来源：Gelato VRF生成weatherSeed，每15分钟计算一次新的天气。
o	天气状态：晴天（正常成长）、暴雨（+20%加速）、风暴（暂停5分钟）、阴天（-10%减缓）。
o	持续时间：15分钟/段，直到作物成熟。
o	机制实现：惰性计算（lazy evaluation），在玩家交互时推进天气和成长进度，无需链上定时器。
•	惰性计算详细逻辑： 惰性计算优化链上资源，只在玩家互动时计算进度。链上存储最小数据，前端可模拟预览。 
1.	存储的核心变量（在土地NFT或关联合约中）：growthStartTime、baseGrowthTime、weatherSeed（VRF生成）、lastWeatherUpdateTime、accumulatedGrowth（初始0，单位秒）、boostersApplied。
2.	天气生成逻辑：基于weatherSeed和时间段伪随机生成（哈希函数映射到天气类型），可重现且随机。段固定15分钟。
3.	推进计算步骤：互动时检查当前时间 > lastWeatherUpdateTime，计算段数；为每个段生成天气、调整并累加到accumulatedGrowth；应用boosters；如果>= baseGrowthTime，更新为Ripe；更新lastWeatherUpdateTime。控制在1-2小时。
4.	优点与注意：零闲置gas，支持离线进度；注意段数上限（e.g.,100），Monad高性能承受。
五、互动机制
1.	抢地：玩家提交claimLand(landId, tokenId)，检查Idle且非冷却，绑定SeedNFT，进入Growing，请求VRF。
2.	成长：进度由基础时长±天气-道具决定，成熟时间1-2小时。
3.	收割：Ripe时主人收割，土地进入LockedIdle，作物计入持有。
4.	偷菜：任何人发起stealCrop，成功转移作物，土地进入LockedIdle，无惩罚。
5.	道具：种类浇水（-2分钟）、施肥（-5%）；用原生币/KIND购买；限每作物10次。
6.	助人奖励：为他人作物用道具获1 KIND；每日限15次。
六、收益与排名设计
1.	作物排名：基于持有成熟作物NFT数量排序；可选加权（稀有=2分、普通=1分、传说=3分）。
2.	善良值排名：基于持有KIND数量排序。
七、总结
设计实现NFT+代币经济、链上闭环、VRF随机性、社交激励和双排行榜，激发竞争与合作。
合约和前端分工
为实现MVP，采用仅合约+前端架构。合约（Solidity编写，使用Foundry框架进行开发、测试和部署，Foundry提供高效的测试工具如forge和cast，支持快速迭代和gas优化）负责核心逻辑和状态；前端（React等+Web3库）负责UI和交互，直接调用合约。无后端，前端处理数据聚合。
合约工作分工（核心逻辑层）
合约分成模块（如SeedNFT、LandNFT、KindnessToken、FarmGame），处理信任敏感部分。
•	资产体系：Mint/update SeedNFT属性；mint/transfer KIND；mint土地，存储状态/变量。
•	作物与成长时间：硬编码时间，嵌入惰性计算。
•	天气与动态事件：种植时请求VRF存储weatherSeed；惰性计算嵌入交互函数（advanceGrowth：计算段、生成天气、调整accumulatedGrowth、更新状态）。
•	互动机制：claimLand（检查/绑定/请求VRF）；harvest（检查/转移/冷却）；stealCrop（转移/冷却）；buyBooster/applyBooster（支付/更新boosters，助人mint KIND，限次）；每日奖励用时间戳追踪。
•	收益与排名：View函数返回用户作物数/KIND（前端聚合排行）。
•	其他：Emit事件；view查询状态/进度；安全（权限/限速）。
前端工作分工（用户交互层）
前端构建Web UI，直接连接钱包调用合约，模拟非链上计算。前端对接基于合约：合约编写完毕后，整理ABI文件（JSON格式，包含函数签名、事件等）和部署地址，提供给前端用于集成。然后再开始编写前端内容，确保前端调用匹配合约接口。
•	资产体系：显示库存/商店，触发购买/兑换。
•	作物与成长时间：详情页模拟剩余时间。
•	天气与动态事件：JS模拟惰性计算预览天气/进度，轮询验证。
•	互动机制：地图点击抢地/道具/收割/偷菜；助人选他人土地显示奖励。
•	收益与排名：查询用户数据，前端排序渲染排行（分页）。
•	其他：钱包集成；事件监听通知；UI动画/错误处理；缓存优化。

